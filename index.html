<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MP3ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ãƒ‡ãƒ¢</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f5f5f5;
            margin: 0;
        }
     
        .player {
            text-align: center;
            padding: 30px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            width: 80%;
            max-width: 500px;
        }
        .brand-logo {
            margin-bottom: 20px;
        }

        .brand-logo img {
            max-width: 100%;
            height: auto;
        }
        h2 {
            color: #333;
            margin-top: 0;
        }
        
        .buttons {
            margin: 20px 0;
        }
        
        button {
            padding: 12px 24px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 0 5px;
        }
        
        button:hover {
            background-color: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        .progress-container {
            width: 100%;
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background-color: #4CAF50;
            width: 0%;
            transition: width 0.5s;
        }
        
        .track-info {
            margin: 20px 0;
            color: #555;
        }
        
        .time-display {
            display: flex;
            justify-content: space-between;
            color: #777;
            font-size: 14px;
        }
        
        .volume-control {
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .volume-control input {
            width: 100px;
            margin: 0 10px;
        }
        
        .volume-icon {
            cursor: pointer;
        }
        
        .error-message {
            color: red;
            margin-top: 10px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="player">
    <!-- ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ­ã‚´/ç”»åƒã‚’è¿½åŠ  -->
    <div class="brand-logo">
        <img src="logo.png" alt="ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ­ã‚´" width="200">
    </div>
        <h2>MP3ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼</h2>
        
        <!-- ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªè¦ç´ ã‚’è¿½åŠ  -->
        <audio id="myAudio" src="voice_mizumagic.mp3"></audio>
        
        <div class="track-info">
            <p><strong>å†ç”Ÿä¸­:</strong> <span id="track-name">ã¿ãšé­”æ³•ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ã‚·ãƒ£ãƒ¯ãƒ¼ãƒˆãƒ«ãƒãƒ¼ãƒ‰</span></p>
        </div>
        
        <div class="progress-container">
            <div class="progress-bar" id="progress"></div>
        </div>
        
        <div class="time-display">
            <span id="current-time">0:00</span>
            <span id="total-time">0:00</span>
        </div>
        
        <div class="buttons">
            <button id="play-btn" onclick="togglePlay()">å†ç”Ÿ</button>
            <button id="stop-btn" onclick="stopAudio()" disabled>åœæ­¢</button>
        </div>
        
        <div class="volume-control">
            <span class="volume-icon" onclick="toggleMute()">ğŸ”Š</span>
            <input type="range" min="0" max="100" value="80" id="volume-slider" oninput="changeVolume(this.value)">
            <span id="volume-value">80%</span>
        </div>
        
        <div class="error-message" id="error-msg"></div>
    </div>

    <script>
        // ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ã®çŠ¶æ…‹
        let isPlaying = false;
        let isMuted = false;
        let interval;
        let currentSeconds = 0;
        let totalSeconds = 0;
        
        // DOMè¦ç´ 
        const playBtn = document.getElementById('play-btn');
        const stopBtn = document.getElementById('stop-btn');
        const progressBar = document.getElementById('progress');
        const currentTimeDisplay = document.getElementById('current-time');
        const volumeSlider = document.getElementById('volume-slider');
        const volumeValue = document.getElementById('volume-value');
        const volumeIcon = document.querySelector('.volume-icon');
        const audioElement = document.getElementById('myAudio');
        const errorMsg = document.getElementById('error-msg');
        
        // ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªãŒèª­ã¿è¾¼ã¾ã‚ŒãŸã‚‰å†ç”Ÿæ™‚é–“ã‚’æ›´æ–°
        audioElement.addEventListener('loadedmetadata', function() {
            totalSeconds = Math.floor(audioElement.duration);
            document.getElementById('total-time').textContent = formatTime(totalSeconds);
            console.log("Audio loaded successfully, duration: " + totalSeconds + " seconds");
        });
        
        // ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚¨ãƒ©ãƒ¼ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        audioElement.addEventListener('error', function(e) {
            console.error('Audio error:', e);
            errorMsg.textContent = 'ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
            errorMsg.style.display = 'block';
        });
        
        // å†ç”Ÿ/ä¸€æ™‚åœæ­¢ã®åˆ‡ã‚Šæ›¿ãˆ
        function togglePlay() {
            if (isPlaying) {
                pauseAudio();
            } else {
                playAudio();
            }
        }
        
        // å†ç”Ÿé–‹å§‹
        function playAudio() {
            // ãƒ—ãƒ­ãƒŸã‚¹ã§å†ç”Ÿã‚’è©¦ã¿ã‚‹ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒãƒªã‚·ãƒ¼å¯¾å¿œï¼‰
            const playPromise = audioElement.play();
            
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    // å†ç”ŸæˆåŠŸ
                    isPlaying = true;
                    playBtn.textContent = 'ä¸€æ™‚åœæ­¢';
                    stopBtn.disabled = false;
                    
                    // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼æ›´æ–°ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«è¨­å®š
                    interval = setInterval(() => {
                        currentSeconds = Math.floor(audioElement.currentTime);
                        updateProgress();
                        if (currentSeconds >= Math.floor(audioElement.duration)) {
                            stopAudio();
                        }
                    }, 1000);
                }).catch(error => {
                    // å†ç”Ÿå¤±æ•—
                    console.error('Playback failed:', error);
                    errorMsg.textContent = 'å†ç”Ÿã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message;
                    errorMsg.style.display = 'block';
                });
            }
        }
        
        // ä¸€æ™‚åœæ­¢
        function pauseAudio() {
            audioElement.pause();
            isPlaying = false;
            playBtn.textContent = 'å†ç”Ÿ';
            clearInterval(interval);
        }
        
        // åœæ­¢
        function stopAudio() {
            pauseAudio();
            audioElement.currentTime = 0;
            currentSeconds = 0;
            updateProgress();
            stopBtn.disabled = true;
        }
        
        // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã¨æ™‚é–“è¡¨ç¤ºã®æ›´æ–°
        function updateProgress() {
            const percentage = (currentSeconds / totalSeconds) * 100;
            progressBar.style.width = `${percentage}%`;
            currentTimeDisplay.textContent = formatTime(currentSeconds);
        }
        
        // ç§’ã‚’ mm:ss å½¢å¼ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
        function formatTime(seconds) {
            if (isNaN(seconds) || !isFinite(seconds)) {
                return "0:00";
            }
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }
        
        // éŸ³é‡å¤‰æ›´
        function changeVolume(value) {
            volumeValue.textContent = `${value}%`;
            audioElement.volume = value / 100;
            
            // éŸ³é‡ã‚¢ã‚¤ã‚³ãƒ³æ›´æ–°
            updateVolumeIcon(value);
        }
        
        // ãƒŸãƒ¥ãƒ¼ãƒˆåˆ‡ã‚Šæ›¿ãˆ
        function toggleMute() {
            isMuted = !isMuted;
            
            if (isMuted) {
                volumeSlider.setAttribute('data-prev-value', volumeSlider.value);
                volumeSlider.value = 0;
                volumeValue.textContent = '0%';
                audioElement.volume = 0;
                volumeIcon.textContent = 'ğŸ”‡';
            } else {
                const prevValue = volumeSlider.getAttribute('data-prev-value') || 80;
                volumeSlider.value = prevValue;
                volumeValue.textContent = `${prevValue}%`;
                audioElement.volume = prevValue / 100;
                updateVolumeIcon(prevValue);
            }
        }
        
        // éŸ³é‡ã‚¢ã‚¤ã‚³ãƒ³æ›´æ–°
        function updateVolumeIcon(value) {
            if (value == 0) {
                volumeIcon.textContent = 'ğŸ”‡';
            } else if (value < 50) {
                volumeIcon.textContent = 'ğŸ”‰';
            } else {
                volumeIcon.textContent = 'ğŸ”Š';
            }
        }
        
        // åˆæœŸéŸ³é‡è¨­å®š
        changeVolume(volumeSlider.value);
        
        console.log("Script loaded. Checking if audio file exists at: voice_mizumagic.mp3");
    </script>
</body>
</html>
